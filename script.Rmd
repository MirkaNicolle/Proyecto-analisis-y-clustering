---
title: "Proyecto analisis exploratorio y clustering"
author: "Andres Quinto, Mirka Monzon, Oscar De Leon, Oscar Ramos, Diego Crespo"
date: "26/03/2022"
output: 
  html_document:
    code_folding: hide
    word_document: default
    pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(haven)
library(foreign)
#Lectura y conversion de los .SAV

# Comentados los savs que ya fueron convertidos en .csv
# write.csv(X2011, 'X2011.csv')
# write.csv(X2012, 'X2012.csv')
# write.csv(X2013, 'X2013.csv')
# write.csv(base1, 'base1.csv')
# write.csv(X2016, 'X2016.csv')
# write.csv(matri2014, 'matri2014 .csv')
# write.csv(matri2015 , 'matri2015 .csv')
# write.csv(matri2016 , 'matri2016 .csv')
# 

datos2011 <- read_sav("D:\\Universidad\\mineria de datos\\ProyectoMineria1\\Proyecto-analisis-y-clustering\\SAVS\\20111.sav")
datos2012 <- read_sav("D:\\Universidad\\mineria de datos\\ProyectoMineria1\\Proyecto-analisis-y-clustering\\SAVS\\20122.sav")
datosNacim2011 <- read_sav("D:\\Universidad\\mineria de datos\\ProyectoMineria1\\Proyecto-analisis-y-clustering\\SAVS\\2011N.sav")
datosNacim2012 <- read_sav("D:\\Universidad\\mineria de datos\\ProyectoMineria1\\Proyecto-analisis-y-clustering\\SAVS\\nacim2012.sav")
datos2019 <- read_sav("D:\\Universidad\\mineria de datos\\ProyectoMineria1\\Proyecto-analisis-y-clustering\\SAVS\\2019.sav")

#---------------------Modificaciones 2011----------------------
#Crear columnas en dataset 2011 NUNUHO, NUNUMU
NUNUHO <- rnorm(nrow(datos2011))
datos2011 <- cbind(datos2011,NUNUHO)
datos2011$NUNUHO <- "None"
NUNUMU <- rnorm(nrow(datos2011))
datos2011 <- cbind(datos2011, NUNUMU)
datos2011$NUNUMU <- "None"
#Poner todas en uppercase 2011
cnames <- colnames(datos2011)
mayu2011 = c()
for (i in 1:length(cnames)){
  mayu2011[i] <- toupper(cnames[i])  
}
colnames(datos2011)<-mayu2011
#cambiar AREAG por AREAGOCU, OCUHOM, OCUMUJ, PUEHOM, PUEMUJ
cnames <- colnames(datos2011)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else if(cnames[i] == "GETHOM"){
    nombresN[i] <- "PUEHOM"
  }
  else if(cnames[i] == "GETMUJ"){
    nombresN[i] <- "PUEMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2011) <- nombresN

#-------------------------Modificaciones 2012------------------------

#Crear columnas en dataset 2012 AÑOOCU, NUNUHO, NUNUMU
AÑOOCU <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012, AÑOOCU)
datos2012$AÑOOCU <- "None"
NUNUHO <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012,NUNUHO)
datos2012$NUNUHO <- "None"
NUNUMU <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012, NUNUMU)
datos2012$NUNUMU <- "NA"
#View(datos2012)
#cambiar AREAG por AREAGOCU, OCUHOM, OCUMUJ, PUEHOM, PUEMUJ
cnames <- colnames(datos2012)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else if(cnames[i] == "GETHOM"){
    nombresN[i] <- "PUEHOM"
  }
  else if(cnames[i] == "GETMUJ"){
    nombresN[i] <- "PUEMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2012) <- nombresN
#datos2012$AÑOOCU <- ifelse(datos2012$AÑOOCU == 'None', 2012, datos2012$AÑOOCU)

#-------------------------Modificaciones 2019------------------------
#Agregar columna areagocu
#Poner todas en uppercase 2019
AREAGOCU <- rnorm(nrow(datos2019))
datos2019 <- cbind(datos2019, AREAGOCU)
datos2019$AREAGOCU <- "None"

#-------------------------Modificaciones Nacimientos 2019------------------------
cnames <- colnames(datosNacim2019)
mayu2011 = c()
for (i in 1:length(cnames)){
  mayu2011[i] <- toupper(cnames[i])  
}
colnames(datosNacim2019)<-mayu2011
#CAMBIOS DE BASE NACIMIENTOS 2011 PARA QUE SEA SIMILAR A 2019
#Poner todas en uppercase 2011
cnames <- colnames(datosNacim2011)
mayu2011 = c()
for (i in 1:length(cnames)){
  mayu2011[i] <- toupper(cnames[i])  
}
colnames(datosNacim2011)<-mayu2011

#Cambiar MUPNAP a MUNPNAP
cnames <- colnames(datosNacim2011)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "MUPNAP"){
    nombresN[i] <- "MUNPNAP"
  }
}
#AGREGAR LAS COLUMNAS FALTANTES Y LLENARLAS DE NONE
TIPOINS <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, TIPOINS)
datosNacim2011$TIPOINS <- "None"

VIAPAR <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, VIAPAR)
datosNacim2011$VIAPAR <- "None"

PAISREP <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PAISREP)
datosNacim2011$PAISREP <- "None"

PUEBLOPP <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PUEBLOPP)
datosNacim2011$PUEBLOPP <- "None"

PAISNACP <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PAISNACP)
datosNacim2011$PAISNACP <- "None"

PAISREM <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PAISREM)
datosNacim2011$PAISREM <- "None"

PUEBLOPM <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PUEBLOPM)
datosNacim2011$PUEBLOPM <- "None"

PAISNACM <- rnorm(nrow(datosNacim2011))
datosNacim2011 <- cbind(datosNacim2011, PAISNACM)
datosNacim2011$PAISNACM <- "None"
#ELIMINAMOS LAS COLUMNAS EXTRAS

datosNacim2011 = datosNacim2011[,!(names(datosNacim2011) %in% c("AREAG","GRETNP", "NACIOP","GRUPETMA","NACIOM"))]

#CAMBIOS DE BASE NACIMIENTOS 2012 PARA QUE SEA SIMILAR A 2019
#Poner todas en uppercase 2012
cnames <- colnames(datosNacim2012)
mayu2011 = c()
for (i in 1:length(cnames)){
  mayu2011[i] <- toupper(cnames[i])  
}
colnames(datosNacim2012)<-mayu2011

#Cambiar MUPNAP a MUNPNAP
cnames <- colnames(datosNacim2012)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "MUPNAP"){
    nombresN[i] <- "MUNPNAP"
  }
}
#AGREGAR LAS COLUMNAS FALTANTES Y LLENARLAS DE NONE
TIPOINS <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, TIPOINS)
datosNacim2012$TIPOINS <- "None"

VIAPAR <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, VIAPAR)
datosNacim2012$VIAPAR <- "None"

PAISREP <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PAISREP)
datosNacim2012$PAISREP <- "None"

PUEBLOPP <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PUEBLOPP)
datosNacim2012$PUEBLOPP <- "None"

PAISNACP <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PAISNACP)
datosNacim2012$PAISNACP <- "None"

PAISREM <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PAISREM)
datosNacim2012$PAISREM <- "None"

PUEBLOPM <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PUEBLOPM)
datosNacim2012$PUEBLOPM <- "None"

PAISNACM <- rnorm(nrow(datosNacim2012))
datosNacim2012 <- cbind(datosNacim2012, PAISNACM)
datosNacim2012$PAISNACM <- "None"
#ELIMINAMOS LAS COLUMNAS EXTRAS

datosNacim2012 = datosNacim2012[,!(names(datosNacim2012) %in% c("AREAG","GRETNP", "NACIOP","GRUPETMA","NACIOM"))]
```

```{r}
library(haven)
library(foreign)

datos2013 <- read_sav("./SAVS/2013M.sav")

#-------------------------Modificaciones 2013 matrimonios------------------------
#columnas a crear para año 2013: NUNUHO, NUNUMU
#no hay columnas para cambiar 

#NUNUHO
NUNUHO <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013,NUNUHO)
datos2013$NUNUHO <- "None"

#NUNUMU
NUNUMU <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013, NUNUMU)
datos2013$NUNUMU <- "NA"

```

```{r}
library(haven)
library(foreign)

datos2014 <- read_sav("./SAVS/2014M.sav")

#-------------------------Modificaciones 2014 matrimonios------------------------
#columnas a crear para año 2014: NUNUHO, NUNUMU
#no hay comunas para cambiar 

#NUNUHO
NUNUHO <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014,NUNUHO)
datos2014$NUNUHO <- "None"

#NUNUMU
NUNUMU <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014, NUNUMU)
datos2014$NUNUMU <- "NA"

#Agregar columna anoocu
AÑOOCU <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014, AÑOOCU)
datos2014$AÑOOCU <- "None"
```

```{r}
library(haven)
library(foreign)

datosN2013 <- read_sav("./SAVS/2013N.sav")

#-------------------------Modificaciones 2013 nacimientos------------------------
#columnas a crear para año 2013: TIPOINS, AÑOOCU, VIAPAR 
#columnas a cambiar: CIUPAD - OCUPAP / CIUMAD - OCUPAM
#columnas a borrar: NACIOP, ESCOLAP, NACIOM 

#TIPOINS
TIPOINS <- rnorm(nrow(datosN2013))
datosN2013 <- cbind(datosN2013,TIPOINS)
datosN2013$TIPOINS <- "None"

#AÑOOCU
AÑOOCU <- rnorm(nrow(datosN2013))
datosN2013 <- cbind(datosN2013,AÑOOCU)
datosN2013$AÑOOCU <- "None"

#VIAPAR
VIAPAR <- rnorm(nrow(datosN2013))
datosN2013 <- cbind(datosN2013,VIAPAR)
datosN2013$VIAPAR <- "None"

#cambio de nombre de columnas
cnames <- colnames(datosN2013)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "CIUPAD"){
    nombresN[i] <- "OCUPAP"
  }
  else if(cnames[i] == "CIUMAD"){
    nombresN[i] <- "OCUPAM"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datosN2013) <- nombresN

#drop NACIOP
datosN2013$NACIOP <- NULL

#drop ESCOLAP
datosN2013$ESCOLAP <- NULL

#drop NACIOM
datosN2013$NACIOM <- NULL
```

```{r}
library(haven)
library(foreign)

datosN2014 <- read_sav("./SAVS/2014N.sav")

#-------------------------Modificaciones 2014 nacimientos------------------------
#columnas a crear para año 2013: TIPOINS, AÑOOCU, VIAPAR, OCUPAP
#columnas a cambiar: NA
#columnas a borrar: CIUMAD  

#TIPOINS
TIPOINS <- rnorm(nrow(datosN2014))
datosN2014 <- cbind(datosN2014,TIPOINS)
datosN2014$TIPOINS <- "None"

#AÑOOCU
AÑOOCU <- rnorm(nrow(datosN2014))
datosN2014 <- cbind(datosN2014,AÑOOCU)
datosN2014$AÑOOCU <- "None"

#VIAPAR
VIAPAR <- rnorm(nrow(datosN2014))
datosN2014 <- cbind(datosN2014,VIAPAR)
datosN2014$VIAPAR <- "None"

#OCUPAP
OCUPAP <- rnorm(nrow(datosN2014))
datosN2014 <- cbind(datosN2014,OCUPAP)
datosN2014$OCUPAP <- "None"

#drop CIUMAD
datosN2014$CIUMAD <- NULL
```


```{r}
library(haven)
library(foreign)

datos2013 <- read_sav("./SAVS/2013M.sav")

#-------------------------Modificaciones 2013------------------------
#columnas a crear para año 2013: NUNUHO, NUNUMU
#no hay columnas para cambiar 
#columnas por borrar: x

#NUNUHO
NUNUHO <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013,NUNUHO)
datos2013$NUNUHO <- "None"

#NUNUMU
NUNUMU <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013, NUNUMU)
datos2013$NUNUMU <- "NA"

#Agregar columna anoocu
AÑOOCU <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013, AÑOOCU)
datos2013$AÑOOCU <- "None"
```



```{r}
library(haven)
library(foreign)

datos2015 <- read_sav("./SAVS/2015M.sav")

#NO FUE NECESARIO REALIZAR CAMBIOS 

```


```{r}
library(haven)
library(foreign)

datosNacim2015 <- read_sav("./SAVS/2015N.sav")

#NO FUE NECESARIO REALIZAR CAMBIOS

```


```{r}
library(haven)
library(foreign)

datosNacim2016 <- read_sav("./SAVS/2016N.sav")

#NO FUE NECESARIO REALIZAR CAMBIOS

```

```{r}
library(haven)
library(foreign)

datos2016 <- read_sav("./SAVS/2016M.sav")

#NO FUE NECESARIO REALIZAR CAMBIOS

```

```{r}
library(haven)
library(foreign)

datosNacim2019 <- read_sav("./2019N.sav")

#NO FUE NECESARIO REALIZAR CAMBIOS

```


```{r}
#UNIMOS LAS BASES DE MATRIMONIOS DEL 2011 AL 2016
#---------- Ya con todas las bases con las mismas columnas (cant columnas y nombres) podemos unirlas 

install.packages("sf")
library(dplyr)
library(sf)
#------------------------Unión de las bases-------------------------
datos2011 <- datos2011 %>%
  mutate_if(is.labelled,list(as_factor))
datos2012 <- datos2012 %>%
  mutate_if(is.labelled,list(as_factor))
datos2013 <- datos2013 %>%
  mutate_if(is.labelled,list(as_factor))
datos2014 <- datos2014 %>%
  mutate_if(is.labelled,list(as_factor))
datos2015 <- datos2015 %>%
  mutate_if(is.labelled,list(as_factor))
datos2016 <- datos2016 %>%
  mutate_if(is.labelled,list(as_factor))

l = list(datos2011,datos2012,datos2013,datos2014,datos2015,datos2016)
datosMatrimonio <- do.call("rbind",l)
datosMatrimonio$EDADHOM <- as.numeric(factor(datosMatrimonio$EDADHOM))
datosMatrimonio$EDADMUJ <- as.numeric(factor(datosMatrimonio$EDADMUJ))

datosMatrimonio$ESCHOM <- ifelse(datosMatrimonio$ESCHOM == "DIversificado","Diversificado",datosMatrimonio$ESCHOM)
datosMatrimonio$ESCHOM <- ifelse(datosMatrimonio$ESCHOM == "Post Grado","Universitario",datosMatrimonio$ESCHOM)
datosMatrimonio$ESCHOM <- ifelse(datosMatrimonio$ESCHOM == "Postgrado","Universitario",datosMatrimonio$ESCHOM)
datosMatrimonio$ESCMUJ <- ifelse(datosMatrimonio$ESCMUJ == "DIversificado","Diversificado",datosMatrimonio$ESCMUJ)
datosMatrimonio$ESCMUJ <- ifelse(datosMatrimonio$ESCMUJ == "Post Grado","Universitario",datosMatrimonio$ESCMUJ)
datosMatrimonio$ESCMUJ <- ifelse(datosMatrimonio$ESCMUJ == "Postgrado","Universitario",datosMatrimonio$ESCMUJ)


datosMatrimonio$DEPOCU <- levels(datosMatrimonio$DEPOCU)[datosMatrimonio$DEPOCU]
datosMatrimonio$DEPOCU <- ifelse(datosMatrimonio$DEPOCU == "Totonicapán","Totonicapan",datosMatrimonio$DEPOCU)
datosMatrimonio$DEPOCU <- ifelse(datosMatrimonio$DEPOCU == "Petén","Peten",datosMatrimonio$DEPOCU)
datosMatrimonio$DEPOCU <- factor(datosMatrimonio$DEPOCU)


datosMatrimonio$PUEHOM <- levels(datosMatrimonio$PUEHOM)[datosMatrimonio$PUEHOM]
datosMatrimonio$PUEMUJ <- levels(datosMatrimonio$PUEMUJ)[datosMatrimonio$PUEMUJ]
datosMatrimonio$PUEHOM <- ifelse(datosMatrimonio$PUEHOM == "No Indigena", "No indigena",datosMatrimonio$PUEHOM)
datosMatrimonio$PUEMUJ <- ifelse(datosMatrimonio$PUEMUJ == "No Indigena", "No indigena",datosMatrimonio$PUEMUJ)
datosMatrimonio$PUEHOM <- factor(datosMatrimonio$PUEHOM)
datosMatrimonio$PUEMUJ <- factor(datosMatrimonio$PUEMUJ)

```
## Informe de análisis exploratorio 

A continuación la explicación de qué representa cada una de las variables:
DEPREG: departamento de registro
MUPREG: municipio de registro
MESREG: mes de registro
AÑOREG: año de registro
CLAUNI: clase de unión
EDADHOM: edad del hombre
EDADMUJ: edad de la mujer
PUEHOM: etnia del hombre
PUEMUJ: etnia de la mujer
NACHOM: nacionalidad del hombre
NACMUJ: nacionalidad de la mujer
CIUOHOM: ocupación del hombre
CIUOMUJ: ocupación de la mujer
NUNUHO: número de nupcias del hombre
NUNUMU: número de nupcias de la mujer
DEPOCU: departamento de ocurrencia
MUPOCU: municipio de ocurrencia
MESOCU: mes de ocurrencia
AÑOOCU: año de ocurrencia
AREAGOCU: área geográfica de ocurrencia
ESCHOM: escolaridad del hombre
ESCMUJ: escolaridad de la mujer

En el siguiente cuadro se muestra el tipo de dato de cada una de las variables mencionadas anteriormente:


```{r data, echo=FALSE}
#
str(datosMatrimonio)
```

Las variables más interesantes para el porpósito de la investigación son las que proporcionan información de la fecha del matrimonio. Otras con gran potencial son las edades de los cónyuges, ya que con ellas podemos analizar cual es la tendencia de matrimonios de menores, diferencias de edades etc.

```{r normalBox, echo=FALSE}
boxplot(datosMatrimonio$AÑOREG, main = "Caja y Bigotes de registro de matrimonios por año", xlab = "Registro por año")
```

Como dicho anteriormente, no hay muchos grupos atípicos ya que se concentran dentro de un intervalo.Según este diagrama, sí se cuenta con normalidad en la cantidad de matrimonios por año.

### Diagrama de qqnormal

```{r normalQQ, echo=FALSE}
qqnorm(datosMatrimonio$AÑOREG, col="blue")
qqline(datosMatrimonio$AÑOREG, col="red")
```

Aunque en el diagrama qqnormal parece que se sigue una distribución normal al encontrarse muchos de los datos alineados, hay bastantes datos que se encuentran fuera de la linea de tendencia, por lo que no se cumple con normalidad en la cantidad de matrimonios por año.

En conclusión, la cantidad de matrimonios por año no sigue una distribución normal.

## Registros de Edad hombre
### Prueba de normalidad para la edad del hombre:

```{r normalHistEdadHombre, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = datosMatrimonio, aes(x = EDADHOM)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(datosMatrimonio$EDADHOM),
                            sd = sd(datosMatrimonio$EDADHOM)))+
  ggtitle("Histograma con curva normal teórica de las edades de los hombres") + 
  theme_bw()
```  

En este histograma se puede observar que los datos tienen relativamente forma de campana, sin embargo, es evidente que estos tienen un sesgo hacia la izquierda, esto quiere decir que usualmente la edad entre los hombres en un matrimonio se encuentra debajo de los 30. Sin embargo, es importante mencionar que como dato interesante se puede observar que hay casos de matrimonios en hombres de más de 75 años. 
Debido al sesgo, la edad de los hombres en matrimonios no sigue una distribución normal.

### Diagrama de caja y bigotes

```{r normalBoxEdadHombre, echo=FALSE}
boxplot(datosMatrimonio$EDADHOM, main = "Caja y Bigotes de edad de los hombres al casarse", xlab = "edad")
```

Se evidencia la gran cantidad de datos atípicos en el diagrama, se encuentran muy dispersos arriba de la media y del extremo superior que se encuentra al rededor de los 30 años. Esto quiere decir que la edad de los hombres en el matrimonio no sigue una distribución normal.

### Diagrama qqnormal

```{r normalQQEdadHombre, echo=FALSE}
qqnorm(datosMatrimonio$EDADHOM, col="blue")
qqline(datosMatrimonio$EDADHOM, col="red")
```

Como puede observarse, es muy notable en el diagrama qqnormal que los datos no siguen una distribución acorde a la linea de tendencia, esto quiere decir que la edad del hombre en el matrimonio no sigue una distribución normal.

En conclusión, la edad de los hombres en el matrimonio no sigue una distribución normal.

## Registros de edad de mujeres
### Prueba de normalidad para la edad de la mujer:

```{r normalHistEdadMuje, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = datosMatrimonio, aes(x = EDADMUJ)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(datosMatrimonio$EDADMUJ),
                            sd = sd(datosMatrimonio$EDADMUJ)))+
  ggtitle("Histograma con curva normal teórica de las edades de las mujeres") + 
  theme_bw()
```  

De la misma manera que en el histograma de hombres, hay una forma relativa de campana, sin embargo se nota un gran sesgo a la izquierda que demuestra que la edad de mujeres en el matrimonio suele ser debajo de los 25, aunque también se cuentan con algunos datos arriba de los 75 años. Debido al sesgo, la edad de mujeres en el matrimonio no sigue una distribución normal.

### Diagrama de caja y bigotes

```{r normalBoxEdadMujer, echo=FALSE}
boxplot(datosMatrimonio$EDADMUJ, main = "Caja y Bigotes de edad de las mujeres al casarse", xlab = "edad")
```

En este diagrama de caja y bigotes es posible ver una gran cantidad de datos atípicos arriba del extremo superior que se encuentra al rededor de los 30 años, muy similar al diagrama de la edad de los hombres, por lo que de la misma manera no se cuenta con normalidad en la edad de las mujeres en el matrimonio.

### Diagrama qqnormal

```{r normalQQEdadMujer, echo=FALSE}
qqnorm(datosMatrimonio$EDADMUJ, col="blue")
qqline(datosMatrimonio$EDADMUJ, col="red")
```

Como puede observarse, los valores en este diagrama evidentemente no siguen con una distribución normal ya que no esán sobre la linea de tendencia, por lo que la edad de las mujeres en el matrimonio no sigue una distribución normal.

En conclusión, la edad de las mujeres en el matrimonio no sigue una distribución normal.
